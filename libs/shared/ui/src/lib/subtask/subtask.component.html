<ng-container *ngIf="state$ | async as state">
  <div class="flex items-center w-full">
    <ui-checkbox
      [checked]="state.done"
      (changedCheck)="onChangedChecked$.next($event)"
    ></ui-checkbox>

    <ng-container *ngIf="!state.isEditing; else editing">
      <span
        class="text-s2 text-black-default ml-2"
        [ngClass]="[state.done ? 'strikethrought text-black-light2' : '']"
        >subtask</span
      >
    </ng-container>
    <ng-template #editing>
      <ui-text-field
        #titleField
        class="ml-2 w-full"
        [text]="state.title"
        (changedValue)="onChangedTitle$.next($event)"
      ></ui-text-field>
    </ng-template>
  </div>

  <ng-container *ngIf="!state.isEditing">
    <div class="flex items-center">
      <ng-container *ngIf="state.selfTrackingTimeSec !== undefined">
        <ui-tracking-log-change-button
          [trackingTimeSec]="state.selfTrackingTimeSec"
          [plannedTimeSec]="state.selfPlannedTimeSec"
          [isTracking]="state.isTracking"
          (changedTrackingTimeSec)="onChangedSelfTrackingTimeSec$.next($event)"
          (changedPlannedTimeSec)="onChangedSelfPlannedTimeSec$.next($event)"
        ></ui-tracking-log-change-button>
      </ng-container>
      <ng-container
        *ngIf="
          state.selfTrackingTimeSec === undefined &&
          state.otherTrackingTimeSec !== undefined
        "
      >
        <ui-time-label
          [status]="'readonly'"
          [sec]="state.otherTrackingTimeSec"
        ></ui-time-label>
      </ng-container>

      <ng-container *ngIf="state.isTracking; else isPause">
        <ui-icon
          class="cursor-pointer ml-2"
          [ngClass]="state.done ? 'visibility-hidden' : ''"
          [icon]="'pause'"
          [size]="'s'"
        ></ui-icon>
      </ng-container>
      <ng-template #isPause>
        <ui-icon
          class="cursor-pointer ml-2"
          [ngClass]="state.done ? 'visibility-hidden' : ''"
          [icon]="'play'"
          [size]="'s'"
        ></ui-icon>
      </ng-template>
    </div>
  </ng-container>
</ng-container>
